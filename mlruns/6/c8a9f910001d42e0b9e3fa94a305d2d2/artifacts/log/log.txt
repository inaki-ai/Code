2021-10-20 15:59:13: Launching WganTrainer...
2021-10-20 15:59:13: Hyperparameters succesfully read from {hyperparams_file}:
2021-10-20 15:59:13: 	net: UNetpp
2021-10-20 15:59:13: 	bilinear: True
2021-10-20 15:59:13: 	n_epochs: 3000
2021-10-20 15:59:13: 	batch_size: 16
2021-10-20 15:59:13: 	dataset: dataset4.yaml
2021-10-20 15:59:13: 	workers: 9
2021-10-20 15:59:13: 	cache: ram
2021-10-20 15:59:13: 	data_augmentation: True
2021-10-20 15:59:13: 	tensorboard: True
2021-10-20 15:59:13: 	random_seed: 42
2021-10-20 15:59:13: 	optimizer: RMSProp
2021-10-20 15:59:13: 	adam_beta1: 0.9
2021-10-20 15:59:13: 	adam_beta2: 0.999
2021-10-20 15:59:13: 	vit_blocks: 8
2021-10-20 15:59:13: 	vit_dim: 512
2021-10-20 15:59:13: 	consistency_term: True
2021-10-20 15:59:13: 	M: 0
2021-10-20 15:59:13: 	learning_rate: 7.5e-05
2021-10-20 15:59:13: 	pretrained_weights_path: /workspace/shared_files/TFM/Code/experiments/exp22/weights/best.pt
2021-10-20 15:59:13: 	pretrained_weights: False
2021-10-20 15:59:13: 	pretrained_weights_generator: True
2021-10-20 15:59:13: 	pretrained_weights_critic: False
2021-10-20 15:59:13: 	pretrained_weights_path_generator: /workspace/shared_files/TFM/Code/experiments/exp22/weights/last.pt
2021-10-20 15:59:13: 	pretrained_weights_path_critic: /workspace/shared_files/TFM/Code/experiments/exp36/weights/best.pt
2021-10-20 15:59:13: 	critic: Critic3_CT_WGAN
2021-10-20 15:59:13: 	generator_learning_rate: 5e-06
2021-10-20 15:59:13: 	critic_learning_rate: 3e-05
2021-10-20 15:59:13: 	n_critic: 5
2021-10-20 15:59:13: Found device: cuda:0
2021-10-20 15:59:13: Transforms dict load succesfully
2021-10-20 15:59:13: Data augmentation dict load succesfully
2021-10-20 15:59:47: Dataset load succesfully
2021-10-20 15:59:48: Generator UNetpp load succesfully
2021-10-20 15:59:48: Critic Critic3_CT_WGAN load succesfully
2021-10-20 15:59:48: Pretained weights of generator load succesfully
2021-10-20 15:59:48: Starting training the model...
2021-10-20 15:59:48: Starting epoch 1
2021-10-20 16:00:54: Epoch 1 finished -- Generator train loss: -0.1240 - Critic train loss: 2.7927 -- Elapsed time: 66.5s
2021-10-20 16:00:58: Last weights saved at epoch 1
2021-10-20 16:00:58: New best value of DSC reach: 0.8396 (last: -1.0000)
2021-10-20 16:00:58: Best weights saved at epoch 1
2021-10-20 16:00:58: Starting epoch 2
2021-10-20 16:02:04: Epoch 2 finished -- Generator train loss: -0.1233 - Critic train loss: 1.3528 -- Elapsed time: 66.2s
2021-10-20 16:02:07: Last weights saved at epoch 2
2021-10-20 16:02:08: Starting epoch 3
2021-10-20 16:03:14: Epoch 3 finished -- Generator train loss: -0.1259 - Critic train loss: 1.3276 -- Elapsed time: 66.5s
2021-10-20 16:03:17: Last weights saved at epoch 3
2021-10-20 16:03:17: Starting epoch 4
2021-10-20 16:04:23: Epoch 4 finished -- Generator train loss: -0.1012 - Critic train loss: 1.1809 -- Elapsed time: 65.7s
2021-10-20 16:04:26: Last weights saved at epoch 4
2021-10-20 16:04:26: Starting epoch 5
2021-10-20 16:05:32: Epoch 5 finished -- Generator train loss: -0.0930 - Critic train loss: 1.2206 -- Elapsed time: 66.1s
2021-10-20 16:05:35: Last weights saved at epoch 5
2021-10-20 16:05:35: Starting epoch 6
2021-10-20 16:06:42: Epoch 6 finished -- Generator train loss: -0.0706 - Critic train loss: 1.2088 -- Elapsed time: 66.1s
2021-10-20 16:06:45: Last weights saved at epoch 6
2021-10-20 16:06:45: Starting epoch 7
2021-10-20 16:07:51: Epoch 7 finished -- Generator train loss: -0.0599 - Critic train loss: 1.0307 -- Elapsed time: 66.0s
2021-10-20 16:07:54: Last weights saved at epoch 7
2021-10-20 16:07:54: Starting epoch 8
2021-10-20 16:09:01: Epoch 8 finished -- Generator train loss: -0.0449 - Critic train loss: 1.1400 -- Elapsed time: 66.7s
2021-10-20 16:09:04: Last weights saved at epoch 8
2021-10-20 16:09:04: Starting epoch 9
2021-10-20 16:10:10: Epoch 9 finished -- Generator train loss: -0.0222 - Critic train loss: 1.3893 -- Elapsed time: 65.8s
2021-10-20 16:10:13: Last weights saved at epoch 9
2021-10-20 16:10:13: Starting epoch 10
2021-10-20 16:11:19: Epoch 10 finished -- Generator train loss: -0.0123 - Critic train loss: 1.0240 -- Elapsed time: 66.3s
2021-10-20 16:11:22: Last weights saved at epoch 10
2021-10-20 16:11:22: Starting epoch 11
2021-10-20 16:12:29: Epoch 11 finished -- Generator train loss: 0.0088 - Critic train loss: 0.9771 -- Elapsed time: 66.7s
2021-10-20 16:12:32: Last weights saved at epoch 11
2021-10-20 16:12:32: Starting epoch 12
2021-10-20 16:13:39: Epoch 12 finished -- Generator train loss: 0.0177 - Critic train loss: 1.0639 -- Elapsed time: 66.0s
2021-10-20 16:13:42: Last weights saved at epoch 12
2021-10-20 16:13:42: Starting epoch 13
2021-10-20 16:14:49: Epoch 13 finished -- Generator train loss: 0.0338 - Critic train loss: 0.9204 -- Elapsed time: 66.5s
2021-10-20 16:14:51: Last weights saved at epoch 13
2021-10-20 16:14:52: Starting epoch 14
2021-10-20 16:15:58: Epoch 14 finished -- Generator train loss: 0.0417 - Critic train loss: 0.9908 -- Elapsed time: 65.9s
2021-10-20 16:16:01: Last weights saved at epoch 14
2021-10-20 16:16:01: Starting epoch 15
2021-10-20 16:17:07: Epoch 15 finished -- Generator train loss: 0.0619 - Critic train loss: 0.8822 -- Elapsed time: 66.1s
2021-10-20 16:17:10: Last weights saved at epoch 15
2021-10-20 16:17:10: Starting epoch 16
2021-10-20 16:18:16: Epoch 16 finished -- Generator train loss: 0.0627 - Critic train loss: 1.0878 -- Elapsed time: 66.0s
2021-10-20 16:18:19: Last weights saved at epoch 16
2021-10-20 16:18:19: Starting epoch 17
2021-10-20 16:19:25: Epoch 17 finished -- Generator train loss: 0.0648 - Critic train loss: 0.9788 -- Elapsed time: 65.8s
2021-10-20 16:19:28: Last weights saved at epoch 17
2021-10-20 16:19:28: Starting epoch 18
2021-10-20 16:20:35: Epoch 18 finished -- Generator train loss: 0.0665 - Critic train loss: 0.8610 -- Elapsed time: 66.6s
2021-10-20 16:20:38: Last weights saved at epoch 18
2021-10-20 16:20:38: Starting epoch 19
2021-10-20 16:21:44: Epoch 19 finished -- Generator train loss: 0.0489 - Critic train loss: 1.1100 -- Elapsed time: 66.1s
2021-10-20 16:21:47: Last weights saved at epoch 19
2021-10-20 16:21:48: Starting epoch 20
2021-10-20 16:22:54: Epoch 20 finished -- Generator train loss: 0.0488 - Critic train loss: 1.1268 -- Elapsed time: 66.4s
2021-10-20 16:22:59: Last weights saved at epoch 20
2021-10-20 16:22:59: Starting epoch 21
2021-10-20 16:24:05: Epoch 21 finished -- Generator train loss: 0.0462 - Critic train loss: 0.9926 -- Elapsed time: 65.9s
2021-10-20 16:24:09: Last weights saved at epoch 21
2021-10-20 16:24:09: Starting epoch 22
2021-10-20 16:25:15: Epoch 22 finished -- Generator train loss: 0.0494 - Critic train loss: 1.3476 -- Elapsed time: 66.4s
2021-10-20 16:25:18: Last weights saved at epoch 22
2021-10-20 16:25:19: New best value of DSC reach: 0.8414 (last: 0.8396)
2021-10-20 16:25:19: Best weights saved at epoch 22
2021-10-20 16:25:19: Starting epoch 23
2021-10-20 16:26:26: Epoch 23 finished -- Generator train loss: 0.0512 - Critic train loss: 1.2837 -- Elapsed time: 66.7s
2021-10-20 16:26:29: Last weights saved at epoch 23
2021-10-20 16:26:29: New best value of DSC reach: 0.8508 (last: 0.8414)
2021-10-20 16:26:29: Best weights saved at epoch 23
2021-10-20 16:26:30: Starting epoch 24
2021-10-20 16:27:36: Epoch 24 finished -- Generator train loss: 0.0430 - Critic train loss: 1.3599 -- Elapsed time: 65.8s
2021-10-20 16:27:39: Last weights saved at epoch 24
2021-10-20 16:27:39: New best value of DSC reach: 0.8550 (last: 0.8508)
2021-10-20 16:27:39: Best weights saved at epoch 24
2021-10-20 16:27:39: Starting epoch 25
2021-10-20 16:28:46: Epoch 25 finished -- Generator train loss: 0.0508 - Critic train loss: 1.4214 -- Elapsed time: 66.5s
2021-10-20 16:28:49: Last weights saved at epoch 25
2021-10-20 16:28:49: New best value of DSC reach: 0.8574 (last: 0.8550)
2021-10-20 16:28:49: Best weights saved at epoch 25
2021-10-20 16:28:50: Starting epoch 26
2021-10-20 16:29:56: Epoch 26 finished -- Generator train loss: 0.0441 - Critic train loss: 1.5034 -- Elapsed time: 66.3s
2021-10-20 16:29:59: Last weights saved at epoch 26
2021-10-20 16:29:59: New best value of DSC reach: 0.8591 (last: 0.8574)
2021-10-20 16:30:00: Best weights saved at epoch 26
2021-10-20 16:30:00: Starting epoch 27
2021-10-20 16:31:06: Epoch 27 finished -- Generator train loss: 0.0441 - Critic train loss: 1.7332 -- Elapsed time: 66.3s
2021-10-20 16:31:09: Last weights saved at epoch 27
2021-10-20 16:31:10: New best value of DSC reach: 0.8593 (last: 0.8591)
2021-10-20 16:31:10: Best weights saved at epoch 27
2021-10-20 16:31:10: Starting epoch 28
2021-10-20 16:32:17: Epoch 28 finished -- Generator train loss: 0.0435 - Critic train loss: 1.6587 -- Elapsed time: 66.8s
2021-10-20 16:32:20: Last weights saved at epoch 28
2021-10-20 16:32:20: New best value of DSC reach: 0.8595 (last: 0.8593)
2021-10-20 16:32:20: Best weights saved at epoch 28
2021-10-20 16:32:21: Starting epoch 29
2021-10-20 16:33:27: Epoch 29 finished -- Generator train loss: 0.0339 - Critic train loss: 1.6097 -- Elapsed time: 66.4s
2021-10-20 16:33:30: Last weights saved at epoch 29
2021-10-20 16:33:30: Starting epoch 30
2021-10-20 16:34:37: Epoch 30 finished -- Generator train loss: 0.0382 - Critic train loss: 1.3868 -- Elapsed time: 66.2s
2021-10-20 16:34:40: Last weights saved at epoch 30
2021-10-20 16:34:40: Starting epoch 31
2021-10-20 16:35:46: Epoch 31 finished -- Generator train loss: 0.0260 - Critic train loss: 1.4552 -- Elapsed time: 66.3s
2021-10-20 16:35:49: Last weights saved at epoch 31
2021-10-20 16:35:50: Starting epoch 32
2021-10-20 16:36:56: Epoch 32 finished -- Generator train loss: 0.0217 - Critic train loss: 1.3419 -- Elapsed time: 66.1s
2021-10-20 16:36:59: Last weights saved at epoch 32
2021-10-20 16:36:59: New best value of DSC reach: 0.8605 (last: 0.8595)
2021-10-20 16:36:59: Best weights saved at epoch 32
2021-10-20 16:37:00: Starting epoch 33
2021-10-20 16:38:06: Epoch 33 finished -- Generator train loss: 0.0247 - Critic train loss: 1.4496 -- Elapsed time: 66.4s
2021-10-20 16:38:09: Last weights saved at epoch 33
2021-10-20 16:38:10: Starting epoch 34
2021-10-20 16:39:16: Epoch 34 finished -- Generator train loss: 0.0228 - Critic train loss: 1.2978 -- Elapsed time: 66.0s
2021-10-20 16:39:19: Last weights saved at epoch 34
2021-10-20 16:39:19: Starting epoch 35
2021-10-20 16:40:26: Epoch 35 finished -- Generator train loss: 0.0255 - Critic train loss: 1.3688 -- Elapsed time: 66.5s
2021-10-20 16:40:29: Last weights saved at epoch 35
2021-10-20 16:40:29: Starting epoch 36
2021-10-20 16:41:35: Epoch 36 finished -- Generator train loss: 0.0231 - Critic train loss: 1.3776 -- Elapsed time: 66.0s
2021-10-20 16:41:38: Last weights saved at epoch 36
2021-10-20 16:41:38: Starting epoch 37
2021-10-20 16:42:45: Epoch 37 finished -- Generator train loss: 0.0207 - Critic train loss: 1.2143 -- Elapsed time: 66.5s
2021-10-20 16:42:48: Last weights saved at epoch 37
2021-10-20 16:42:48: Starting epoch 38
2021-10-20 16:43:55: Epoch 38 finished -- Generator train loss: 0.0193 - Critic train loss: 1.3046 -- Elapsed time: 66.5s
2021-10-20 16:43:58: Last weights saved at epoch 38
2021-10-20 16:43:58: Starting epoch 39
2021-10-20 16:45:04: Epoch 39 finished -- Generator train loss: 0.0160 - Critic train loss: 1.4581 -- Elapsed time: 66.2s
2021-10-20 16:45:07: Last weights saved at epoch 39
2021-10-20 16:45:07: Starting epoch 40
2021-10-20 16:46:14: Epoch 40 finished -- Generator train loss: 0.0235 - Critic train loss: 1.3110 -- Elapsed time: 66.3s
2021-10-20 16:46:19: Last weights saved at epoch 40
2021-10-20 16:46:19: Starting epoch 41
2021-10-20 16:47:25: Epoch 41 finished -- Generator train loss: 0.0201 - Critic train loss: 1.5758 -- Elapsed time: 66.1s
2021-10-20 16:47:29: Last weights saved at epoch 41
2021-10-20 16:47:29: Starting epoch 42
2021-10-20 16:48:35: Epoch 42 finished -- Generator train loss: 0.0181 - Critic train loss: 1.4974 -- Elapsed time: 66.2s
2021-10-20 16:48:38: Last weights saved at epoch 42
2021-10-20 16:48:38: Starting epoch 43
2021-10-20 16:49:45: Epoch 43 finished -- Generator train loss: 0.0193 - Critic train loss: 1.3798 -- Elapsed time: 66.9s
2021-10-20 16:49:49: Last weights saved at epoch 43
2021-10-20 16:49:49: Starting epoch 44
2021-10-20 16:50:55: Epoch 44 finished -- Generator train loss: 0.0093 - Critic train loss: 1.3267 -- Elapsed time: 66.4s
2021-10-20 16:50:59: Last weights saved at epoch 44
2021-10-20 16:50:59: Starting epoch 45
2021-10-20 16:52:05: Epoch 45 finished -- Generator train loss: 0.0051 - Critic train loss: 1.4231 -- Elapsed time: 66.4s
2021-10-20 16:52:09: Last weights saved at epoch 45
2021-10-20 16:52:09: Starting epoch 46
2021-10-20 16:53:15: Epoch 46 finished -- Generator train loss: 0.0077 - Critic train loss: 1.1037 -- Elapsed time: 66.5s
2021-10-20 16:53:18: Last weights saved at epoch 46
2021-10-20 16:53:19: Starting epoch 47
2021-10-20 16:54:25: Epoch 47 finished -- Generator train loss: 0.0070 - Critic train loss: 1.3808 -- Elapsed time: 66.3s
2021-10-20 16:54:28: Last weights saved at epoch 47
2021-10-20 16:54:28: Starting epoch 48
2021-10-20 16:55:36: Epoch 48 finished -- Generator train loss: 0.0044 - Critic train loss: 1.2686 -- Elapsed time: 66.9s
2021-10-20 16:55:39: Last weights saved at epoch 48
2021-10-20 16:55:39: Starting epoch 49
2021-10-20 16:56:45: Epoch 49 finished -- Generator train loss: 0.0037 - Critic train loss: 1.2615 -- Elapsed time: 66.4s
2021-10-20 16:56:49: Last weights saved at epoch 49
2021-10-20 16:56:49: Starting epoch 50
2021-10-20 16:57:55: Epoch 50 finished -- Generator train loss: 0.0072 - Critic train loss: 1.3620 -- Elapsed time: 66.1s
2021-10-20 16:57:58: Last weights saved at epoch 50
2021-10-20 16:57:58: Starting epoch 51
2021-10-20 16:59:05: Epoch 51 finished -- Generator train loss: 0.0055 - Critic train loss: 0.9129 -- Elapsed time: 66.2s
2021-10-20 16:59:08: Last weights saved at epoch 51
2021-10-20 16:59:08: Starting epoch 52
2021-10-20 17:00:15: Epoch 52 finished -- Generator train loss: 0.0050 - Critic train loss: 0.8469 -- Elapsed time: 66.5s
2021-10-20 17:00:18: Last weights saved at epoch 52
2021-10-20 17:00:18: Starting epoch 53
2021-10-20 17:01:25: Epoch 53 finished -- Generator train loss: 0.0081 - Critic train loss: 0.8605 -- Elapsed time: 66.9s
2021-10-20 17:01:28: Last weights saved at epoch 53
2021-10-20 17:01:28: Starting epoch 54
2021-10-20 17:02:35: Epoch 54 finished -- Generator train loss: 0.0090 - Critic train loss: 0.8498 -- Elapsed time: 66.6s
2021-10-20 17:02:38: Last weights saved at epoch 54
2021-10-20 17:02:38: Starting epoch 55
2021-10-20 17:03:45: Epoch 55 finished -- Generator train loss: 0.0122 - Critic train loss: 0.7383 -- Elapsed time: 66.8s
2021-10-20 17:03:48: Last weights saved at epoch 55
2021-10-20 17:03:49: Starting epoch 56
2021-10-20 17:04:55: Epoch 56 finished -- Generator train loss: 0.0137 - Critic train loss: 0.6438 -- Elapsed time: 65.9s
2021-10-20 17:04:58: Last weights saved at epoch 56
2021-10-20 17:04:58: Starting epoch 57
2021-10-20 17:06:04: Epoch 57 finished -- Generator train loss: 0.0159 - Critic train loss: 0.8050 -- Elapsed time: 66.2s
2021-10-20 17:06:08: Last weights saved at epoch 57
2021-10-20 17:06:08: Starting epoch 58
2021-10-20 17:07:15: Epoch 58 finished -- Generator train loss: 0.0226 - Critic train loss: 0.8024 -- Elapsed time: 66.6s
2021-10-20 17:07:18: Last weights saved at epoch 58
2021-10-20 17:07:18: Starting epoch 59
2021-10-20 17:08:24: Epoch 59 finished -- Generator train loss: 0.0175 - Critic train loss: 0.8615 -- Elapsed time: 66.5s
2021-10-20 17:08:28: Last weights saved at epoch 59
2021-10-20 17:08:28: Starting epoch 60
2021-10-20 17:09:34: Epoch 60 finished -- Generator train loss: 0.0216 - Critic train loss: 0.9967 -- Elapsed time: 66.1s
2021-10-20 17:09:40: Last weights saved at epoch 60
2021-10-20 17:09:40: Starting epoch 61
2021-10-20 17:10:47: Epoch 61 finished -- Generator train loss: 0.0241 - Critic train loss: 0.8001 -- Elapsed time: 66.3s
2021-10-20 17:10:50: Last weights saved at epoch 61
2021-10-20 17:10:50: Starting epoch 62
2021-10-20 17:11:56: Epoch 62 finished -- Generator train loss: 0.0232 - Critic train loss: 0.6725 -- Elapsed time: 66.0s
2021-10-20 17:11:59: Last weights saved at epoch 62
2021-10-20 17:12:00: Starting epoch 63
2021-10-20 17:13:07: Epoch 63 finished -- Generator train loss: 0.0254 - Critic train loss: 0.9018 -- Elapsed time: 67.0s
2021-10-20 17:13:10: Last weights saved at epoch 63
2021-10-20 17:13:10: Starting epoch 64
2021-10-20 17:14:17: Epoch 64 finished -- Generator train loss: 0.0249 - Critic train loss: 0.8696 -- Elapsed time: 66.4s
2021-10-20 17:14:20: Last weights saved at epoch 64
2021-10-20 17:14:20: Starting epoch 65
2021-10-20 17:15:27: Epoch 65 finished -- Generator train loss: 0.0262 - Critic train loss: 1.2039 -- Elapsed time: 66.3s
2021-10-20 17:15:30: Last weights saved at epoch 65
2021-10-20 17:15:30: Starting epoch 66
2021-10-20 17:16:37: Epoch 66 finished -- Generator train loss: 0.0218 - Critic train loss: 1.0016 -- Elapsed time: 66.2s
2021-10-20 17:16:40: Last weights saved at epoch 66
2021-10-20 17:16:40: Starting epoch 67
2021-10-20 17:17:46: Epoch 67 finished -- Generator train loss: 0.0196 - Critic train loss: 1.0439 -- Elapsed time: 66.1s
2021-10-20 17:17:50: Last weights saved at epoch 67
2021-10-20 17:17:50: Starting epoch 68
2021-10-20 17:18:57: Epoch 68 finished -- Generator train loss: 0.0208 - Critic train loss: 0.8398 -- Elapsed time: 67.0s
2021-10-20 17:19:00: Last weights saved at epoch 68
2021-10-20 17:19:00: Starting epoch 69
2021-10-20 17:20:07: Epoch 69 finished -- Generator train loss: 0.0178 - Critic train loss: 0.6308 -- Elapsed time: 66.3s
2021-10-20 17:20:10: Last weights saved at epoch 69
2021-10-20 17:20:10: Starting epoch 70
2021-10-20 17:21:18: Epoch 70 finished -- Generator train loss: 0.0186 - Critic train loss: 0.6615 -- Elapsed time: 67.2s
2021-10-20 17:21:21: Last weights saved at epoch 70
