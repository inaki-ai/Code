2021-10-22 19:17:33: Launching WganTrainer...
2021-10-22 19:17:33: Hyperparameters succesfully read from {hyperparams_file}:
2021-10-22 19:17:33: 	net: UNetpp
2021-10-22 19:17:33: 	bilinear: True
2021-10-22 19:17:33: 	n_epochs: 3000
2021-10-22 19:17:33: 	batch_size: 16
2021-10-22 19:17:33: 	dataset: dataset5.yaml
2021-10-22 19:17:33: 	workers: 9
2021-10-22 19:17:33: 	cache: ram
2021-10-22 19:17:33: 	data_augmentation: True
2021-10-22 19:17:33: 	tensorboard: True
2021-10-22 19:17:33: 	random_seed: 42
2021-10-22 19:17:33: 	optimizer: RMSProp
2021-10-22 19:17:33: 	adam_beta1: 0.9
2021-10-22 19:17:33: 	adam_beta2: 0.999
2021-10-22 19:17:33: 	vit_blocks: 8
2021-10-22 19:17:33: 	vit_dim: 512
2021-10-22 19:17:33: 	consistency_term: True
2021-10-22 19:17:33: 	M: 0
2021-10-22 19:17:33: 	learning_rate: 7.5e-05
2021-10-22 19:17:33: 	pretrained_weights_path: /workspace/shared_files/TFM/Code/experiments/exp31/weights/last.pt
2021-10-22 19:17:33: 	pretrained_weights: False
2021-10-22 19:17:33: 	pretrained_weights_generator: True
2021-10-22 19:17:33: 	pretrained_weights_critic: False
2021-10-22 19:17:33: 	pretrained_weights_path_generator: /workspace/shared_files/TFM/Code/experiments/exp31/weights/last.pt
2021-10-22 19:17:33: 	pretrained_weights_path_critic: /workspace/shared_files/TFM/Code/experiments/exp36/weights/best.pt
2021-10-22 19:17:33: 	critic: Critic3_CT_WGAN
2021-10-22 19:17:33: 	generator_learning_rate: 2.5e-06
2021-10-22 19:17:33: 	critic_learning_rate: 3e-05
2021-10-22 19:17:33: 	n_critic: 5
2021-10-22 19:17:33: Found device: cuda:0
2021-10-22 19:17:33: Transforms dict load succesfully
2021-10-22 19:17:33: Data augmentation dict load succesfully
2021-10-22 19:18:15: Dataset load succesfully
2021-10-22 19:18:16: Generator UNetpp load succesfully
2021-10-22 19:18:16: Critic Critic3_CT_WGAN load succesfully
2021-10-22 19:18:16: Pretained weights of generator load succesfully
2021-10-22 19:18:16: Starting training the model...
2021-10-22 19:18:16: Starting epoch 1
2021-10-22 19:19:49: Epoch 1 finished -- Generator train loss: -0.1148 - Critic train loss: 2.1909 -- Elapsed time: 92.5s
2021-10-22 19:19:52: Last weights saved at epoch 1
2021-10-22 19:19:52: New best value of DSC reach: 0.8729 (last: -1.0000)
2021-10-22 19:19:53: Best weights saved at epoch 1
2021-10-22 19:19:53: Starting epoch 2
2021-10-22 19:21:25: Epoch 2 finished -- Generator train loss: -0.1097 - Critic train loss: 1.3010 -- Elapsed time: 91.7s
2021-10-22 19:21:28: Last weights saved at epoch 2
2021-10-22 19:21:28: Starting epoch 3
2021-10-22 19:22:58: Epoch 3 finished -- Generator train loss: -0.0980 - Critic train loss: 1.2557 -- Elapsed time: 89.6s
2021-10-22 19:23:01: Last weights saved at epoch 3
2021-10-22 19:23:01: Starting epoch 4
2021-10-22 19:24:31: Epoch 4 finished -- Generator train loss: -0.0867 - Critic train loss: 1.2767 -- Elapsed time: 89.8s
2021-10-22 19:24:35: Last weights saved at epoch 4
2021-10-22 19:24:35: Starting epoch 5
2021-10-22 19:26:05: Epoch 5 finished -- Generator train loss: -0.0862 - Critic train loss: 1.1586 -- Elapsed time: 90.0s
2021-10-22 19:26:08: Last weights saved at epoch 5
2021-10-22 19:26:08: Starting epoch 6
2021-10-22 19:27:38: Epoch 6 finished -- Generator train loss: -0.0713 - Critic train loss: 1.2953 -- Elapsed time: 89.7s
2021-10-22 19:27:42: Last weights saved at epoch 6
2021-10-22 19:27:42: Starting epoch 7
2021-10-22 19:29:11: Epoch 7 finished -- Generator train loss: -0.0566 - Critic train loss: 1.0742 -- Elapsed time: 89.6s
2021-10-22 19:29:15: Last weights saved at epoch 7
2021-10-22 19:29:15: Starting epoch 8
2021-10-22 19:30:45: Epoch 8 finished -- Generator train loss: -0.0418 - Critic train loss: 1.0052 -- Elapsed time: 89.5s
2021-10-22 19:30:48: Last weights saved at epoch 8
2021-10-22 19:30:48: Starting epoch 9
2021-10-22 19:32:18: Epoch 9 finished -- Generator train loss: -0.0192 - Critic train loss: 1.2173 -- Elapsed time: 89.8s
2021-10-22 19:32:21: Last weights saved at epoch 9
2021-10-22 19:32:22: Starting epoch 10
2021-10-22 19:33:52: Epoch 10 finished -- Generator train loss: -0.0023 - Critic train loss: 1.1627 -- Elapsed time: 90.0s
2021-10-22 19:33:55: Last weights saved at epoch 10
2021-10-22 19:33:55: Starting epoch 11
2021-10-22 19:35:25: Epoch 11 finished -- Generator train loss: 0.0164 - Critic train loss: 0.9844 -- Elapsed time: 89.8s
2021-10-22 19:35:28: Last weights saved at epoch 11
2021-10-22 19:35:29: Starting epoch 12
2021-10-22 19:36:58: Epoch 12 finished -- Generator train loss: 0.0250 - Critic train loss: 0.9142 -- Elapsed time: 89.6s
2021-10-22 19:37:02: Last weights saved at epoch 12
2021-10-22 19:37:02: Starting epoch 13
2021-10-22 19:38:31: Epoch 13 finished -- Generator train loss: 0.0398 - Critic train loss: 0.8978 -- Elapsed time: 89.5s
2021-10-22 19:38:35: Last weights saved at epoch 13
2021-10-22 19:38:35: Starting epoch 14
2021-10-22 19:40:05: Epoch 14 finished -- Generator train loss: 0.0430 - Critic train loss: 0.9866 -- Elapsed time: 89.5s
2021-10-22 19:40:08: Last weights saved at epoch 14
2021-10-22 19:40:08: Starting epoch 15
2021-10-22 19:41:38: Epoch 15 finished -- Generator train loss: 0.0508 - Critic train loss: 0.8558 -- Elapsed time: 90.0s
2021-10-22 19:41:41: Last weights saved at epoch 15
2021-10-22 19:41:42: Starting epoch 16
2021-10-22 19:43:11: Epoch 16 finished -- Generator train loss: 0.0613 - Critic train loss: 0.8986 -- Elapsed time: 89.5s
2021-10-22 19:43:15: Last weights saved at epoch 16
2021-10-22 19:43:15: Starting epoch 17
2021-10-22 19:44:45: Epoch 17 finished -- Generator train loss: 0.0626 - Critic train loss: 0.9648 -- Elapsed time: 89.9s
2021-10-22 19:44:48: Last weights saved at epoch 17
2021-10-22 19:44:48: Starting epoch 18
2021-10-22 19:46:18: Epoch 18 finished -- Generator train loss: 0.0642 - Critic train loss: 1.0745 -- Elapsed time: 90.1s
2021-10-22 19:46:22: Last weights saved at epoch 18
2021-10-22 19:46:22: Starting epoch 19
2021-10-22 19:47:52: Epoch 19 finished -- Generator train loss: 0.0693 - Critic train loss: 1.0897 -- Elapsed time: 89.8s
2021-10-22 19:47:55: Last weights saved at epoch 19
2021-10-22 19:47:55: Starting epoch 20
2021-10-22 19:49:25: Epoch 20 finished -- Generator train loss: 0.0737 - Critic train loss: 1.0746 -- Elapsed time: 89.9s
2021-10-22 19:49:33: Last weights saved at epoch 20
2021-10-22 19:49:33: Starting epoch 21
2021-10-22 19:51:03: Epoch 21 finished -- Generator train loss: 0.0660 - Critic train loss: 1.1408 -- Elapsed time: 90.5s
2021-10-22 19:51:07: Last weights saved at epoch 21
2021-10-22 19:51:07: Starting epoch 22
2021-10-22 19:52:37: Epoch 22 finished -- Generator train loss: 0.0693 - Critic train loss: 1.2153 -- Elapsed time: 90.1s
2021-10-22 19:52:41: Last weights saved at epoch 22
2021-10-22 19:52:41: Starting epoch 23
2021-10-22 19:54:11: Epoch 23 finished -- Generator train loss: 0.0652 - Critic train loss: 1.3557 -- Elapsed time: 90.4s
2021-10-22 19:54:15: Last weights saved at epoch 23
2021-10-22 19:54:15: Starting epoch 24
2021-10-22 19:55:47: Epoch 24 finished -- Generator train loss: 0.0637 - Critic train loss: 1.2674 -- Elapsed time: 91.9s
2021-10-22 19:55:51: Last weights saved at epoch 24
2021-10-22 19:55:51: Starting epoch 25
2021-10-22 19:57:22: Epoch 25 finished -- Generator train loss: 0.0595 - Critic train loss: 1.2111 -- Elapsed time: 90.6s
2021-10-22 19:57:25: Last weights saved at epoch 25
2021-10-22 19:57:25: Starting epoch 26
2021-10-22 19:58:56: Epoch 26 finished -- Generator train loss: 0.0523 - Critic train loss: 1.2745 -- Elapsed time: 90.7s
2021-10-22 19:59:00: Last weights saved at epoch 26
2021-10-22 19:59:00: Starting epoch 27
2021-10-22 20:00:30: Epoch 27 finished -- Generator train loss: 0.0516 - Critic train loss: 1.3789 -- Elapsed time: 89.7s
2021-10-22 20:00:33: Last weights saved at epoch 27
2021-10-22 20:00:33: Starting epoch 28
2021-10-22 20:02:00: Epoch 28 finished -- Generator train loss: 0.0413 - Critic train loss: 1.5346 -- Elapsed time: 86.7s
2021-10-22 20:02:04: Last weights saved at epoch 28
2021-10-22 20:02:04: Starting epoch 29
2021-10-22 20:03:31: Epoch 29 finished -- Generator train loss: 0.0332 - Critic train loss: 1.4441 -- Elapsed time: 86.8s
2021-10-22 20:03:34: Last weights saved at epoch 29
2021-10-22 20:03:34: Starting epoch 30
2021-10-22 20:05:02: Epoch 30 finished -- Generator train loss: 0.0347 - Critic train loss: 1.3531 -- Elapsed time: 87.0s
2021-10-22 20:05:05: Last weights saved at epoch 30
2021-10-22 20:05:05: New best value of DSC reach: 0.8764 (last: 0.8729)
2021-10-22 20:05:06: Best weights saved at epoch 30
2021-10-22 20:05:06: Starting epoch 31
2021-10-22 20:06:37: Epoch 31 finished -- Generator train loss: 0.0275 - Critic train loss: 1.7580 -- Elapsed time: 90.6s
2021-10-22 20:06:40: Last weights saved at epoch 31
2021-10-22 20:06:41: Starting epoch 32
2021-10-22 20:08:11: Epoch 32 finished -- Generator train loss: 0.0236 - Critic train loss: 1.6056 -- Elapsed time: 90.5s
2021-10-22 20:08:15: Last weights saved at epoch 32
2021-10-22 20:08:15: Starting epoch 33
2021-10-22 20:09:47: Epoch 33 finished -- Generator train loss: 0.0250 - Critic train loss: 1.8156 -- Elapsed time: 91.9s
2021-10-22 20:09:51: Last weights saved at epoch 33
2021-10-22 20:09:51: Starting epoch 34
2021-10-22 20:11:23: Epoch 34 finished -- Generator train loss: 0.0153 - Critic train loss: 1.5154 -- Elapsed time: 92.2s
2021-10-22 20:11:27: Last weights saved at epoch 34
2021-10-22 20:11:27: New best value of DSC reach: 0.8772 (last: 0.8764)
2021-10-22 20:11:27: Best weights saved at epoch 34
2021-10-22 20:11:27: Starting epoch 35
2021-10-22 20:13:00: Epoch 35 finished -- Generator train loss: 0.0152 - Critic train loss: 1.3130 -- Elapsed time: 92.6s
2021-10-22 20:13:04: Last weights saved at epoch 35
2021-10-22 20:13:04: New best value of DSC reach: 0.8788 (last: 0.8772)
2021-10-22 20:13:04: Best weights saved at epoch 35
2021-10-22 20:13:04: Starting epoch 36
2021-10-22 20:14:36: Epoch 36 finished -- Generator train loss: 0.0161 - Critic train loss: 1.4219 -- Elapsed time: 92.1s
2021-10-22 20:14:40: Last weights saved at epoch 36
2021-10-22 20:14:40: New best value of DSC reach: 0.8791 (last: 0.8788)
2021-10-22 20:14:40: Best weights saved at epoch 36
2021-10-22 20:14:40: Starting epoch 37
2021-10-22 20:16:09: Epoch 37 finished -- Generator train loss: 0.0111 - Critic train loss: 1.5298 -- Elapsed time: 87.9s
2021-10-22 20:16:12: Last weights saved at epoch 37
2021-10-22 20:16:12: Starting epoch 38
2021-10-22 20:17:42: Epoch 38 finished -- Generator train loss: 0.0062 - Critic train loss: 1.2743 -- Elapsed time: 90.3s
2021-10-22 20:17:46: Last weights saved at epoch 38
2021-10-22 20:17:46: New best value of DSC reach: 0.8792 (last: 0.8791)
2021-10-22 20:17:46: Best weights saved at epoch 38
2021-10-22 20:17:46: Starting epoch 39
2021-10-22 20:19:19: Epoch 39 finished -- Generator train loss: 0.0046 - Critic train loss: 1.2725 -- Elapsed time: 92.7s
2021-10-22 20:19:23: Last weights saved at epoch 39
2021-10-22 20:19:23: Starting epoch 40
2021-10-22 20:20:58: Epoch 40 finished -- Generator train loss: 0.0081 - Critic train loss: 1.1393 -- Elapsed time: 94.8s
2021-10-22 20:21:05: Last weights saved at epoch 40
2021-10-22 20:21:05: Starting epoch 41
2021-10-22 20:22:37: Epoch 41 finished -- Generator train loss: 0.0069 - Critic train loss: 1.1568 -- Elapsed time: 91.9s
2021-10-22 20:22:41: Last weights saved at epoch 41
2021-10-22 20:22:41: Starting epoch 42
2021-10-22 20:24:13: Epoch 42 finished -- Generator train loss: 0.0034 - Critic train loss: 1.2584 -- Elapsed time: 91.7s
2021-10-22 20:24:17: Last weights saved at epoch 42
2021-10-22 20:24:17: Starting epoch 43
2021-10-22 20:25:48: Epoch 43 finished -- Generator train loss: 0.0058 - Critic train loss: 1.2883 -- Elapsed time: 91.1s
2021-10-22 20:25:52: Last weights saved at epoch 43
2021-10-22 20:25:52: Starting epoch 44
2021-10-22 20:27:25: Epoch 44 finished -- Generator train loss: 0.0043 - Critic train loss: 1.0475 -- Elapsed time: 92.7s
2021-10-22 20:27:28: Last weights saved at epoch 44
2021-10-22 20:27:29: Starting epoch 45
2021-10-22 20:29:00: Epoch 45 finished -- Generator train loss: 0.0028 - Critic train loss: 1.0851 -- Elapsed time: 90.9s
2021-10-22 20:29:03: Last weights saved at epoch 45
2021-10-22 20:29:04: Starting epoch 46
2021-10-22 20:30:35: Epoch 46 finished -- Generator train loss: -0.0004 - Critic train loss: 0.8895 -- Elapsed time: 90.8s
2021-10-22 20:30:38: Last weights saved at epoch 46
2021-10-22 20:30:38: Starting epoch 47
2021-10-22 20:32:09: Epoch 47 finished -- Generator train loss: 0.0040 - Critic train loss: 1.2267 -- Elapsed time: 90.8s
2021-10-22 20:32:13: Last weights saved at epoch 47
2021-10-22 20:32:13: Starting epoch 48
2021-10-22 20:33:43: Epoch 48 finished -- Generator train loss: 0.0048 - Critic train loss: 1.0839 -- Elapsed time: 90.3s
2021-10-22 20:33:47: Last weights saved at epoch 48
2021-10-22 20:33:47: Starting epoch 49
2021-10-22 20:35:17: Epoch 49 finished -- Generator train loss: 0.0065 - Critic train loss: 0.9911 -- Elapsed time: 89.5s
2021-10-22 20:35:20: Last weights saved at epoch 49
2021-10-22 20:35:21: Starting epoch 50
2021-10-22 20:36:52: Epoch 50 finished -- Generator train loss: 0.0146 - Critic train loss: 0.7896 -- Elapsed time: 91.7s
2021-10-22 20:36:56: Last weights saved at epoch 50
2021-10-22 20:36:56: Starting epoch 51
2021-10-22 20:38:31: Epoch 51 finished -- Generator train loss: 0.0150 - Critic train loss: 0.9221 -- Elapsed time: 94.3s
2021-10-22 20:38:36: Last weights saved at epoch 51
2021-10-22 20:38:36: Starting epoch 52
2021-10-22 20:40:07: Epoch 52 finished -- Generator train loss: 0.0176 - Critic train loss: 0.7928 -- Elapsed time: 90.6s
2021-10-22 20:40:11: Last weights saved at epoch 52
2021-10-22 20:40:12: Starting epoch 53
2021-10-22 20:41:44: Epoch 53 finished -- Generator train loss: 0.0180 - Critic train loss: 0.7436 -- Elapsed time: 92.3s
2021-10-22 20:41:48: Last weights saved at epoch 53
2021-10-22 20:41:49: Starting epoch 54
2021-10-22 20:43:19: Epoch 54 finished -- Generator train loss: 0.0177 - Critic train loss: 0.8263 -- Elapsed time: 89.7s
2021-10-22 20:43:22: Last weights saved at epoch 54
2021-10-22 20:43:22: Starting epoch 55
2021-10-22 20:44:53: Epoch 55 finished -- Generator train loss: 0.0153 - Critic train loss: 0.9499 -- Elapsed time: 90.9s
2021-10-22 20:44:57: Last weights saved at epoch 55
2021-10-22 20:44:57: Starting epoch 56
2021-10-22 20:46:33: Epoch 56 finished -- Generator train loss: 0.0204 - Critic train loss: 0.6346 -- Elapsed time: 95.1s
2021-10-22 20:46:37: Last weights saved at epoch 56
2021-10-22 20:46:38: Starting epoch 57
2021-10-22 20:48:13: Epoch 57 finished -- Generator train loss: 0.0189 - Critic train loss: 0.6919 -- Elapsed time: 95.0s
2021-10-22 20:48:17: Last weights saved at epoch 57
2021-10-22 20:48:18: Starting epoch 58
2021-10-22 20:49:48: Epoch 58 finished -- Generator train loss: 0.0157 - Critic train loss: 0.5555 -- Elapsed time: 89.8s
2021-10-22 20:49:52: Last weights saved at epoch 58
2021-10-22 20:49:52: Starting epoch 59
2021-10-22 20:51:25: Epoch 59 finished -- Generator train loss: 0.0183 - Critic train loss: 0.6538 -- Elapsed time: 92.6s
2021-10-22 20:51:29: Last weights saved at epoch 59
2021-10-22 20:51:29: Starting epoch 60
2021-10-22 20:53:03: Epoch 60 finished -- Generator train loss: 0.0185 - Critic train loss: 0.7073 -- Elapsed time: 93.8s
2021-10-22 20:53:10: Last weights saved at epoch 60
2021-10-22 20:53:11: New best value of DSC reach: 0.8792 (last: 0.8792)
2021-10-22 20:53:11: Best weights saved at epoch 60
2021-10-22 20:53:11: Starting epoch 61
2021-10-22 20:54:44: Epoch 61 finished -- Generator train loss: 0.0241 - Critic train loss: 0.6822 -- Elapsed time: 92.2s
2021-10-22 20:54:47: Last weights saved at epoch 61
2021-10-22 20:54:48: New best value of DSC reach: 0.8795 (last: 0.8792)
2021-10-22 20:54:48: Best weights saved at epoch 61
2021-10-22 20:54:48: Starting epoch 62
2021-10-22 20:56:20: Epoch 62 finished -- Generator train loss: 0.0210 - Critic train loss: 0.6931 -- Elapsed time: 91.7s
2021-10-22 20:56:24: Last weights saved at epoch 62
2021-10-22 20:56:24: Starting epoch 63
2021-10-22 20:57:56: Epoch 63 finished -- Generator train loss: 0.0189 - Critic train loss: 0.6342 -- Elapsed time: 91.9s
2021-10-22 20:58:00: Last weights saved at epoch 63
2021-10-22 20:58:00: Starting epoch 64
2021-10-22 20:59:32: Epoch 64 finished -- Generator train loss: 0.0205 - Critic train loss: 0.6282 -- Elapsed time: 91.9s
2021-10-22 20:59:36: Last weights saved at epoch 64
2021-10-22 20:59:36: Starting epoch 65
2021-10-22 21:01:05: Epoch 65 finished -- Generator train loss: 0.0167 - Critic train loss: 0.4843 -- Elapsed time: 88.2s
2021-10-22 21:01:08: Last weights saved at epoch 65
2021-10-22 21:01:08: Starting epoch 66
2021-10-22 21:02:41: Epoch 66 finished -- Generator train loss: 0.0129 - Critic train loss: 0.4005 -- Elapsed time: 92.3s
2021-10-22 21:02:44: Last weights saved at epoch 66
2021-10-22 21:02:45: Starting epoch 67
2021-10-22 21:04:18: Epoch 67 finished -- Generator train loss: 0.0094 - Critic train loss: 0.7181 -- Elapsed time: 93.0s
2021-10-22 21:04:21: Last weights saved at epoch 67
2021-10-22 21:04:22: Starting epoch 68
2021-10-22 21:05:53: Epoch 68 finished -- Generator train loss: 0.0064 - Critic train loss: 0.6729 -- Elapsed time: 91.1s
2021-10-22 21:05:57: Last weights saved at epoch 68
2021-10-22 21:05:57: Starting epoch 69
2021-10-22 21:07:27: Epoch 69 finished -- Generator train loss: 0.0037 - Critic train loss: 0.6988 -- Elapsed time: 90.1s
2021-10-22 21:07:31: Last weights saved at epoch 69
2021-10-22 21:07:31: Starting epoch 70
